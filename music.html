<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Music â€“ Nelson Serrano</title>
  <link rel="stylesheet" href="style.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet"/>
</head>
<body>
  <div id="animated-bg"></div>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="films.html">Films</a></li>
      <li><a href="music.html">Music</a></li>
      <li><a href="hinterland.html">Hinterland</a></li>
    </ul>
  </nav>

  <main class="content">
    <h1 class="hero">Music + Sound</h1>
    <p class="hero-subtitle">Original compositions and soundtracks.</p>

    <section class="audio-block" data-palette="superstar">
      <h2 class="hover-bob">Superstar (V2.)</h2>
      <p class="track-blurb">
        Superstar (V2.) was commissioned by an independent filmmaker who wanted a sleazy top 40s disco hit from the future.
      </p>
      <audio controls id="audio-superstar">
        <source src="assets/Superstar.mp3" type="audio/mpeg" />
        Your browser does not support the audio element.
      </audio>
      <div class="audio-visualizer" id="visualizer-superstar">
        <div></div><div></div><div></div><div></div><div></div>
      </div>
    </section>

    <section class="audio-block" data-palette="thecold">
      <h2 class="hover-bob">The Cold</h2>
      <p class="track-blurb">
        The Cold was completed using open source software (Cakewalk) and plugins. Though I have since moved to Ableton, this is my first song that I am proud of production-wise.
      </p>
      <audio controls id="audio-cold">
        <source src="assets/The Cold.mp3" type="audio/mpeg" />
        Your browser does not support the audio element.
      </audio>
      <div class="audio-visualizer" id="visualizer-cold">
        <div></div><div></div><div></div><div></div><div></div>
      </div>
    </section>
  </main>
  <div id="global-audio-player" style="position:fixed;bottom:1.5rem;left:1.5rem;z-index:9999;display:none;background:#fff3;border-radius:12px;box-shadow:0 2px 8px #0002;padding:0.7em 1.2em;">
    <audio id="global-audio" controls style="width:220px;"></audio>
    <span id="global-audio-title" style="margin-left:0.7em;font-size:1rem;color:#00809D;"></span>
  </div>
  <script type="module">
  import { animateGhost, animateUfo, createParticles, animateHue } from './animations.js';
  import { highlightPlayingAudio } from './audio.js';
  import { sectionFadeIn, pageFadeInOnLoad, pageFadeOutOnNav } from './navigation.js';
  import { paletteSwitcher } from './ui.js';
  import { paletteScrollObserver } from './palette.js';


  animateGhost();
  animateUfo();
  createParticles();
  animateHue();
  highlightPlayingAudio();
  sectionFadeIn();
  pageFadeInOnLoad();    
  pageFadeOutOnNav();
  paletteSwitcher();
  paletteScrollObserver();

  document.addEventListener('DOMContentLoaded', () => {
    if (localStorage.getItem('musicAutoplay') === 'cold') {
      // Set blue palette
      localStorage.setItem('paletteIndex', 3);
      paletteSwitcher(); // <-- Set palette first

      // Play "The Cold"
      const audio = document.getElementById('audio-cold');
      if (audio) {
        audio.play();
      }
      localStorage.removeItem('musicAutoplay');
    }
  });
</script>
</body>
</html>
