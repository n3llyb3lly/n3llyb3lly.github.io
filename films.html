<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Films â€“ Nelson Serrano</title>
  <link rel="stylesheet" href="style.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet"/>
</head>
<body>
  <div id="animated-bg"></div>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="films.html">Films</a></li>
      <li><a href="music.html">Music</a></li>
      <li><a href="hinterland.html">Hinterland</a></li>
    </ul>
  </nav>

  <main class="content">
    <h1 class="hero">Films</h1>
    <p class="hero-subtitle">Short films, experiments, and visual stories.</p>

    <section class="video-block" id="higher-living" data-palette="higherliving">
      <div class="video-frame-container">
        <h2 class="hover-bob video-title">Higher Living</h2>
        <iframe width="560" height="315" src="https://www.youtube.com/embed/4JtCrQ4ELsk" 
                title="Higher Living" frameborder="0" allowfullscreen></iframe>
      </div>
    </section>

    <section class="video-block">
      <div class="video-frame-container">
        <h2 class="hover-bob video-title">Lingering</h2>
        <iframe width="560" height="315" src="https://www.youtube.com/embed/7qF1GJLhenQ" 
                title="Linger" frameborder="0" allowfullscreen></iframe>
      </div>
    </section>
  </main>
  <div id="global-audio-player" style="position:fixed;bottom:1.5rem;left:1.5rem;z-index:9999;display:none;background:#fff3;border-radius:12px;box-shadow:0 2px 8px #0002;padding:0.7em 1.2em;">
    <audio id="global-audio" controls style="width:220px;"></audio>
    <span id="global-audio-title" style="margin-left:0.7em;font-size:1rem;color:#00809D;"></span>
  </div>
  <script src="global-audio.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      document.body.classList.add('page-visible');
    });
  </script>
  <script type="module">
  import { animateGhost, animateUfo, createParticles, animateHue } from './animations.js';
  import { highlightPlayingAudio } from './audio.js';
  import { sectionFadeIn, pageFadeInOnLoad, pageFadeOutOnNav } from './navigation.js';
  import { paletteSwitcher, hoverDialogue, typewriterEffect } from './ui.js';
  import { paletteScrollObserver } from './palette.js';

  // Call only what you need for this page:
  animateGhost();
  animateUfo();
  createParticles();
  animateHue();
  highlightPlayingAudio();
  sectionFadeIn();
  pageFadeInOnLoad();
  pageFadeOutOnNav();
  paletteSwitcher();
  hoverDialogue();
  typewriterEffect();
  paletteScrollObserver();

  document.addEventListener('DOMContentLoaded', () => {
    if (localStorage.getItem('filmAutoplay') === 'higher-living') {
      // Set green palette
      localStorage.setItem('paletteIndex', 1);
      paletteSwitcher(); // <-- Set palette first

      // Play "Higher Living" (YouTube iframe)
      const iframe = document.querySelector('iframe[src*="4JtCrQ4ELsk"]');
      if (iframe) {
        iframe.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
      }
      localStorage.removeItem('filmAutoplay');
    }
  });
</script>
</body>
</html>
